---
title: "Homework 8"
author: "Author: Matthew J. Cossley"
date: "Last update: `r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    toc_float:
        collapsed: true
        smooth_scroll: true
    toc_depth: 3
    fig_caption: yes
    number_sections: false
    theme: cosmo
fontsize: 14pt
---
```{r global-options, include=FALSE}
knitr::opts_chunk$set(warning=FALSE)
```

```{r setup, include=FALSE, message=F}
knitr::opts_chunk$set(echo = T, collapse=T, warning=F)
```

<style type="text/css">
  body{
  font-size: 18pt;
}

<style type="text/css">
.table {

    width: 40%;
}
</style>

```{r, echo=F}
library(data.table)
library(ggplot2)
library(ggpubr)
library(latex2exp)
```

* Create a new file named `cogs2020_hw_8.R` and save it in
the `cogs2020` folder that you created during Lecture 1.

* If you have not already installed the `data.table` and the
`ggplot2` packages, do so now. If you use the
`install.packages` function, do not include it in the script
that you hand in.

* If you have not already installed the `ez` package, do so
now. If you use the `install.packages` function, do not
include it in the script that you hand in.

* Make the first line of your script `library(data.table)`
the second line `library(ggplot2)`, and the third line
`library(ez)`.

* Make the second line of your script `rm(list=ls())`. This
line of code will erase any variable defined before it. Do
not put this line of code after anything important that you
want to keep (e.g., so that I can mark your work).

* After `rm(list=ls())`, create a variable named `my_name`
and set its value equal to a **character** vector (i.e.,
letters surrounded by `""` or by `''`) containing your name.

* After `rm(list=ls())`, create a variable named
`my_student_id` and set its value equal to a **character**
vector (i.e., letters surrounded by `""` or by `''`)
containing your student id.

* So far, here is what your file should look like if your
name is `John Doe` and and your student ID is `12345678`.
Note that the following code chunk also includes a few lines
to create a `data.table` named `d` that many of the problems
below require you manipulate.

```{r, echo=T}
# load the packages we will need
library(data.table)
library(ggplot2)
library(ez)

# clean session
rm(list=ls())

# basic id info
my_name <- "John Doe"
my_student_id <- "12345678"

# Please include the following line of code as well
set.seed(0)
```

## 1. 
Consider the following data:

```{r, echo=F}
a <- rnorm(5, 10, 2)
b <- rnorm(5, 12, 2)
c <- rnorm(5, 14, 2)
d <- rnorm(5, 10, 2)
d <- data.table(a, b, c, d)
d
```

* Assume that the observations in columns `a` are drawn from
a random variable $A \sim \mathcal{N}(\mu_A, \sigma_A)$.

* Assume that the observations in columns `b` are drawn from
a random variable $B \sim \mathcal{N}(\mu_B, \sigma_B)$.

* Assume that the observations in columns `c` are drawn from
a random variable $C \sim \mathcal{N}(\mu_C, \sigma_C)$.

* Assume that the observations in columns `d` are drawn from
a random variable $D \sim \mathcal{N}(\mu_D, \sigma_D)$.

* Using a one-way ANOVA, test the hypothesis that $\mu_A$,
$\mu_B$, $\mu_C$, and $\mu_D$ are different. Please populate
the following variables:

```{r, eval=F}
ans_1_obs # observed test statistic
ans_1_pval # p-value of test 
ans_1_crit # critical value of test
```

## 2.
Consider the following sampling distribution of an
$F_{obs}$ test statistic (indicated by the dashed line in
the plot), with $df_{between} = 10$ and $df_{within} = 100$.

```{r, echo=F}
set.seed(1)
x <- seq(0, 4, 0.01)
fx <- df(x, 10, 100)
f_obs <- rf(1, 10, 100)
d <- data.table(x, fx)
ggplot(d, aes(x, fx)) +
  geom_line() +
  geom_vline(xintercept = f_obs, linetype=2) +
  scale_x_continuous(breaks=c(0, f_obs, 1, 2, 3, 4)) +
  xlab('F') +
  ylab('Probability Density') +
  annotate('text', x=f_obs, y=0, label='F observed')
```

* Are the mean sqaured deviations greater within groups or
are they greater between groups? Please respond with one of
the following:

  * `ans_2a <- "within"` 
  * `ans_2a <- "between"` 
  
* What is the p-value of this test? Please store your answer
in a variable named `ans_2b`.

* What is the critical value of this test? Please store your
answer in a variable named `ans_2c`.


## 3.
Consider the motor learning experiment data located here:

https://crossley.github.io/cogs2020/data/mis/mis_data.csv

* This data is from a motor learning and motor control
experiment.

* On each trial, participants simply rested their hand in
the middle of a desk, and then tried to move their hand
quickly and accurately to a visual target somewhere on a
circle centred at their hand position and with a radius of
about 8 cm.

* We tested two different groups of people. One group were
college students, and the other group were professional
surgeons.

* The columns of this data file correspond to the following:

  * `subject`: Anonymous subject ID
  * `group`: Indicates college student or surgeon
  * `phase`: Indicates the phase of the experiment
  * `trial`: Trial number
  * `target`: The visual target was reached to for this trial
  * `error`: The mismatch between the centre of the target and the final hand position
  * `movement_time`: How long the movement lasted
  * `reaction_time`: How long until the movement began
  * `peak_velocity`: The maximum velocity reached during the reach

* Please note that this is a between subjects design with
respect to `condition`. This means that different subjects
are in each level of `condition`. This is true despite the
`subject` numbers being identical. They are only identical
because of an error in how the data were processed.

* Is the mean `error` per `subject` different across
different levels of `condition`? Answer this question by
performing a one-way ANOVA. Please populate the following
variables:

```{r, eval=F}
ans_3_obs # observed test statistic
ans_3_pval # pvalue of test 
ans_3_crit # critical value of test statistic
```

## 4.
Repeat problem 3 but this time use an appropriate
t-test (assuming there is equal variance in different
conditions).

```{r, eval=F}
ans_4_obs # observed test statistic
ans_4_pval # pvalue of test 
ans_4_crit # critical value of test statistic
```

## Final Check
A common error on these problem sets is to accidentally
erase or overwrite variables from one question with those
from another. Another common error is to name your variables
slightly wrong (e.g., `Ans_1a` instead of `ans_1a`). Yet
another common error is to include a line of code or two
that generates an error, and sometimes this error is serious
enough to prevent most or all of your script from running,
in which case you will lose most or all of your marks for
that assignment. All of these can be a very frustrating way
to lose marks, but you will indeed lose marks if you make
these mistakes, so you need to be very careful!

To ensure that this doesn't happen to you, please run your
entire `.R` script from start to finish. One way to do this
is to use `Code > Run Region > Run All`, but of course there
are shortcuts for everything so do as you wish. If there are
any errors at all when you do this, it is essential that you
address them.

After all of your code has executed from start to finish
without and errors at all, then carefully inspect your
workspace to ensure that the following variables are
defined. A reasonable way to do this is to try to print each
one of these variables to the console. If it is defined,
then it will print without error.

```{r, eval=F, echo=T}
ans_1_obs
ans_1_pval
ans_1_crit
ans_2a
ans_2b
ans_2c
ans_3_obs
ans_3_pval
ans_3_crit
ans_4_obs
ans_4_pval
ans_4_crit
```

Finally, be sure that the file you submit to iLearn is a
`.R` file and nothing else. Any other extension cannot be
marked. This means do not submit `.Rmd`, `.RProj`, `.pdf`,
`.html` or anything else. You must submit a `.R` file.