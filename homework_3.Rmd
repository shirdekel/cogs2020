---
title: "Homework 3"
author: "Author: Matthew J. Cossley"
date: "Last update: `r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    toc_float:
        collapsed: true
        smooth_scroll: true
    toc_depth: 3
    fig_caption: yes
    number_sections: false
    theme: cosmo
fontsize: 18pt
---
```{r global-options, include=FALSE}
knitr::opts_chunk$set(warning=FALSE)
```

<style type="text/css">
  body{
  font-size: 18pt;
}

<style type="text/css">
.table {

    width: 40%;
}
</style>

```{r, echo=F}
library(data.table)
library(ggplot2)
library(ggpubr)
library(latex2exp)
```

## 0.
* Create a new file named `cogs2020_hw_3.R` and save it in
the `cogs2020` folder that you created during Lecture 1.

* If you have not already installed the `data.table` and the
`ggplot2` packages, do so now. If you use the
`install.packages` function, do not include it in the script
that you hand in.

* Make the first line of your script `library(data.table)`
and the second line `library(ggplot2)`.

* Make the second line of your script `rm(list=ls())`. This
line of code will erase any variable defined before it. Do
not put this line of code after anything important that you
want to keep (e.g., so that I can mark your work).

* After `rm(list=ls())`, create a variable named `my_name`
and set its value equal to a **character** vector (i.e.,
letters surrounded by `""` or by `''`) containing your name.

* After `rm(list=ls())`, create a variable named
`my_student_id` and set its value equal to a **character**
vector (i.e., letters surrounded by `""` or by `''`)
containing your student id.

* So far, here is what your file should look like if your
name is `John Doe` and and your student ID is `12345678`.
Note that the following code chunk also includes a few lines
to create a `data.table` named `d` that many of the problems
below require you manipulate.
```{r, echo=T}
# load the packages we will need
library(data.table)
library(ggplot2)

# clean session
rm(list=ls())

# basic id info
my_name <- "John Doe"
my_student_id <- "12345678"

# Please include the following line of code as well
set.seed(0)
```

## 1.

Consider the following two random variables:

* $X\sim\mathcal{N}(\mu=0,\sigma=1)$ 

* $Y{\sim}Binom(n=10,p=0.2)$ 

The $X$ probability distribution (pdf since X is continuous) and
the $Y$ probability distribution (pmf since Y is discrete) are 
illustrated below. The probability corresponding to $x{\leq}1$
and $y{\leq}3$ (`lower.tail=TRUE`) are coloured blue and the the 
probability corresponding to $x{>}1$ and $y{>}3$ (`lower.tail=FALSE`)
are coloured green. This figure is only here to help you think about 
what is being asked below.

```{r, echo=F, fig.width=10}
x <- seq(-4, 4, 0.01)
fx <- dnorm(x)
d <- data.table(x, fx)
ga <- ggplot(d, aes(x, fx)) +
  geom_line() +
  geom_segment(aes(x=1, xend=1, y=0, yend=dnorm(1)), linetype=2) +
  geom_ribbon(data=d[x<=1],
              aes(x=x, ymin=0, ymax=fx),
              fill='blue',
              alpha=0.25) +
  geom_ribbon(data=d[x>1],
              aes(x=x, ymin=0, ymax=fx),
              fill='green',
              alpha=0.25) +
  annotate("text", x=-0.5, y=0.05, label=TeX("$P(X\\leq x)$")) +
  annotate("text", x=1.5, y=0.05, label=TeX("$P(X>x)$"))+
  ylab('f(x)')

n <- 10
p <- 0.2
y <- seq(0, n, 1)
fy <- dbinom(y, n, p)
d <- data.table(y, fy)
gb <- ggplot(d, aes(y, fy)) +
  geom_segment(data=d[y<=3], aes(x=y, xend=y, y=0, yend=dbinom(y,n,p)), colour='blue') +
  geom_segment(data=d[y>3], aes(x=y, xend=y, y=0, yend=dbinom(y,n,p)), colour='green') +
  annotate("text", x=3, y=0.21, label=TeX("$P(Y\\leq y)$")) +
  annotate("text", x=4, y=0.1, label="P(Y>y)") +
  scale_x_continuous(breaks=0:10) +
  ylab('f(y)')

ggarrange(ga, gb, ncol=2)
```

**(a)** Verify that $p(X{<}x)=p(X{\leq}x)$ for $x=1$.
Do this by performing the following steps:

* Define a variable `p1` and set its value to $p(X{<}x)$.

* Define a variable `p2` and set its value to
  $p(X{\leq}x)$.

* Define a variable `ans_1a` and set its value to `TRUE`
  if `p1` is equal to `p2` and set its value to `FALSE`
  otherwise.

**(b)** Verify that $p(Y < y) \neq p(Y\leq y)$ for $y=3$.
Do this by performing the following steps:

* Define a variable `p1` and set its value to $p(Y < y)$.

* Define a variable `p2` and set its value to
  $p(Y \leq y)$.

* Define a variable `ans_1b` and set its value to `TRUE`
  if `p1` is equal to `p2` and set its value to `FALSE`
  otherwise.

## 2.

Consider the following random variables:

* $X{\sim}\mathcal{N}(\mu_X=15,\sigma_X=2.74)$ 

* $Y{\sim}Binom(n=30,p=0.5)$.

The $X$ and $Y$ distributions are illustrated in the
following figure:

```{r, echo=F, fig.width=10}
x <- seq(0, 30, 0.01)
fx <- dnorm(x, 15, 2.74)
d <- data.table(x, fx)
gx <- ggplot(d, aes(x, fx)) +
  geom_line() +
  ylab('f(x)')

n <- 30
p <- 0.5
y <- seq(0, 30, 1)
fy <- dbinom(y, n, p)
d <- data.table(y, fy)
gy <- ggplot(d, aes(y, fy)) +
  geom_segment(aes(x=y, xend=y, y=0, yend=fy)) + 
  ylab('f(y)')

ggarrange(gx, gy, ncol=2)
```

**(a)** Compute $P(X > 17)$ and store it in a variable
named `ans_2a`.

**(b)** Compute $P(X \leq 14)$ and store it in a variable
named `ans_2b`.

**(c)** Compute $P(X \geq 20)$ and store it in a variable
named `ans_2c`.

**(d)** Compute $P(X < 13)$ and store it in a variable
named `ans_2d`.

**(e)** Compute $P(Y > 17)$ and store it in a variable
named `ans_2e`.

**(f)** Compute $P(Y \leq 14)$ and store it in a variable
named `ans_2f`.

**(g)** Compute $P(Y \geq 20)$ and store it in a variable
named `ans_2g`.

**(h)** Compute $P(Y < 13)$ and store it in a variable
named `ans_2h`.

**(i)** How do all of the above quantities computed with
respect to $X$ compare to those computed with respect to
$Y$? No points for this one. Just think about it.

<!-- **(e)** Compute $P(12.22 < X < 24.55)$ and store it in a -->
<!-- variable named `ans_2e`. -->

<!-- **(f)** Compute $x$ such that $P(X>x) = .9$ and store it in -->
<!-- a variable named `ans_2f`. -->

<!-- **(g)** Compute $x$ such that $P(X \leq x) = .8$ and store -->
<!-- it in a variable named `ans_2g`. -->

## 3.

Consider the following plots:

```{r, echo=F, fig.height=14, fig.width=10}
xcritvec <- c(17, 14, 20, 13)

mu <- 15
sigma <- 2.74

x <- seq((mu-sigma*4), (mu+sigma*4), 0.01)
fxd <- dnorm(x, mu, sigma)

fxp <- pnorm(x, mu, sigma, lower.tail=F)
d <- data.table(x, fxd, fxp)
xcrit <- xcritvec[1]
ga1n <- ggplot(d, aes(x, fxd)) +
  geom_line() +
  geom_ribbon(data=d[x>xcrit],
              aes(x=x, ymin=0, ymax=fxd),
              fill='blue',
              alpha=0.25) +
  ylab('f(x)')

ga2n <- ggplot(d, aes(x, fxp)) +
  geom_line() +
  geom_segment(x=xcrit,
               xend=xcrit,
               y=0,
               yend=pnorm(xcrit, mu, sigma, lower.tail=F),
               linetype=2) +
  geom_segment(x=min(x),
               xend=xcrit,
               y=pnorm(xcrit, mu, sigma, lower.tail=F),
               yend=pnorm(xcrit, mu, sigma, lower.tail=F),
               linetype=2) +
  ylab('P(X>x)')

fxp <- pnorm(x, mu, sigma, lower.tail=T)
d <- data.table(x, fxd, fxp)
xcrit <- xcritvec[2]
gb1n <- ggplot(d, aes(x, fxd)) +
  geom_line() +
  geom_ribbon(data=d[x <= xcrit],
              aes(x=x, ymin=0, ymax=fxd),
              fill='blue',
              alpha=0.25) +
  ylab('f(x)')

gb2n <- ggplot(d, aes(x, fxp)) +
  geom_line() +
  geom_segment(x=xcrit,
               xend=xcrit,
               y=0,
               yend=pnorm(xcrit, mu, sigma, lower.tail=T),
               linetype=2) +
  geom_segment(x=min(x),
               xend=xcrit,
               y=pnorm(xcrit, mu, sigma, lower.tail=T),
               yend=pnorm(xcrit, mu, sigma, lower.tail=T),
               linetype=2) +
  ylab('P(X<=x)')

fxp <- pnorm(x, mu, sigma, lower.tail=F)
d <- data.table(x, fxd, fxp)
xcrit <- xcritvec[3]
gc1n <- ggplot(d, aes(x, fxd)) +
  geom_line() +
  geom_ribbon(data=d[x >= xcrit],
              aes(x=x, ymin=0, ymax=fxd),
              fill='blue',
              alpha=0.25) +
  ylab('f(x)')

gc2n <- ggplot(d, aes(x, fxp)) +
  geom_line() +
  geom_segment(x=xcrit,
               xend=xcrit,
               y=0,
               yend=pnorm(xcrit, mu, sigma, lower.tail=F),
               linetype=2) +
  geom_segment(x=min(x),
               xend=xcrit,
               y=pnorm(xcrit, mu, sigma, lower.tail=F),
               yend=pnorm(xcrit, mu, sigma, lower.tail=F),
               linetype=2) +
  ylab('P(X>x)')

fxp <- pnorm(x, mu, sigma, lower.tail=T)
d <- data.table(x, fxd, fxp)
xcrit <- xcritvec[4]
gd1n <- ggplot(d, aes(x, fxd)) +
  geom_line() +
  geom_ribbon(data=d[x < xcrit],
              aes(x=x, ymin=0, ymax=fxd),
              fill='blue',
              alpha=0.25) +
  ylab('f(x)')

gd2n <- ggplot(d, aes(x, 1-fxp)) +
  geom_line() +
  geom_segment(x=xcrit,
               xend=xcrit,
               y=0,
               yend=pnorm(xcrit, mu, sigma, lower.tail=F),
               linetype=2) +
  geom_segment(x=min(x),
               xend=xcrit,
               y=pnorm(xcrit, mu, sigma, lower.tail=F),
               yend=pnorm(xcrit, mu, sigma, lower.tail=F),
               linetype=2) +
  ylab(TeX('P(X\\leq x)'))

n <- 30
p <- 0.5
x <- seq(0, n, 1)

fxd <- dbinom(x, n, p)
fxp <- pbinom(x, n, p, lower.tail=F)
d <- data.table(x, fxd, fxp)
xcrit <- xcritvec[1]
ga1b <- ggplot(d, aes(x, fxd)) +
  geom_segment(data=d[x>xcrit], aes(x=x, xend=x, y=0, yend=fxd), colour='blue') +
  geom_segment(data=d[x<=xcrit], aes(x=x, xend=x, y=0, yend=fxd)) +
  ylab('f(x)') +
  scale_x_continuous(breaks=seq(0,n,2))

ga2b <- ggplot(d, aes(x, fxp)) +
  geom_point() +
  geom_segment(x=xcrit, 
               xend=xcrit, 
               y=0, 
               yend=pbinom(xcrit, n, p, lower.tail=F), 
               linetype=2) +
  geom_segment(x=min(x),
               xend=xcrit,
               y=pbinom(xcrit, n, p, lower.tail=F),
               yend=pbinom(xcrit, n, p, lower.tail=F),
               linetype=2) +
  ylab('P(X>x)') +
  scale_x_continuous(breaks=seq(0,n,2))

fxd <- dbinom(x, n, p)
fxp <- pbinom(x, n, p, lower.tail=T)
d <- data.table(x, fxd, fxp)
xcrit <- xcritvec[2]
gb1b <- ggplot(d, aes(x, fxd)) +
  geom_segment(data=d[x<=xcrit], aes(x=x, xend=x, y=0, yend=fxd), colour='blue') +
  geom_segment(data=d[x>xcrit], aes(x=x, xend=x, y=0, yend=fxd)) +
  ylab('f(x)') +
  scale_x_continuous(breaks=seq(0,n,2))

gb2b <- ggplot(d, aes(x, fxp)) +
  geom_point() +
  geom_segment(x=xcrit, 
               xend=xcrit, 
               y=0, 
               yend=pbinom(xcrit, n, p, lower.tail=T), 
               linetype=2) +
  geom_segment(x=min(x),
               xend=xcrit,
               y=pbinom(xcrit, n, p, lower.tail=T),
               yend=pbinom(xcrit, n, p, lower.tail=T),
               linetype=2) +
  ylab('P(X<=x)') +
  scale_x_continuous(breaks=seq(0,n,2))

fxd <- dbinom(x, n, p)
fxp <- pbinom(x, n, p, lower.tail=F)
d <- data.table(x, fxd, fxp)
xcrit <- xcritvec[3]
gc1b <- ggplot(d, aes(x, fxd)) +
  geom_segment(data=d[x>=xcrit], aes(x=x, xend=x, y=0, yend=fxd), colour='blue') +
  geom_segment(data=d[x<xcrit], aes(x=x, xend=x, y=0, yend=fxd)) +
  ylab('f(x)') +
  scale_x_continuous(breaks=seq(0,n,2))

gc2b <- ggplot(d, aes(x, fxp)) +
  geom_point() +
  geom_segment(x=xcrit-1, 
               xend=xcrit-1, 
               y=0, 
               yend=pbinom(xcrit-1, n, p, lower.tail=F), 
               linetype=2) +
  geom_segment(x=min(x),
               xend=xcrit-1,
               y=pbinom(xcrit-1, n, p, lower.tail=F),
               yend=pbinom(xcrit-1, n, p, lower.tail=F),
               linetype=2) +
  ylab('P(X>x)') +
  scale_x_continuous(breaks=seq(0,n,2))

fxd <- dbinom(x, n, p)
fxp <- pbinom(x, n, p, lower.tail=T)
d <- data.table(x, fxd, fxp)
xcrit <- xcritvec[4]
gd1b <- ggplot(d, aes(x, fxd)) +
  geom_segment(data=d[x<xcrit], aes(x=x, xend=x, y=0, yend=fxd), colour='blue') +
  geom_segment(data=d[x>=xcrit], aes(x=x, xend=x, y=0, yend=fxd)) +
  ylab('f(x)') +
  scale_x_continuous(breaks=seq(0,n,2))

gd2b <- ggplot(d, aes(x, fxp)) +
  geom_point() +
  geom_segment(x=xcrit-1, 
               xend=xcrit-1, 
               y=0, 
               yend=pbinom(xcrit-1, n, p, lower.tail=T), 
               linetype=2) +
  geom_segment(x=min(x),
               xend=xcrit-1,
               y=pbinom(xcrit-1, n, p, lower.tail=T),
               yend=pbinom(xcrit-1, n, p, lower.tail=T),
               linetype=2) +
  ylab('P(X<=x)') +
  scale_x_continuous(breaks=seq(0,n,2))

list_1 <- list(ga1n, gb1n, gc1n, gd1n, ga1b, gb1b, gc1b, gd1b)
list_2 <- list(ga2n, gb2n, gc2n, gd2n, ga2b, gb2b, gc2b, gd2b)
plot_list_list <- list(list_1, list_2)

set.seed(2)
inds1 <- sample(1:8, 8)
inds2 <- sample(rep(1:2, 4), 8)

plot_list <- list()
for(i in 1:8) {
  plot_list[[i]] <- plot_list_list[[inds2[i]]][[inds1[i]]]
}

plot_labels <- list('I', 'II', 'III', 'IV',
                    'V', 'VI', 'VII', 'VIII')

ggarrange(
  plotlist=plot_list,
  labels=plot_labels,
  nrow=4,
  ncol=2)
```

For each of the following problems, please respond by
setting the appropriate variable to one of `"I"`, `"II"`,
`"III"`, `"IV"`, `"V"`, `"VI"`, `"VII"`, or `"VIII"`.
When responding to the questions below, please note that 
the x and y axis labels in the above plots all use 'X' or 
'x' but may correspond to either the X or the Y random variable 
from problem 2.

**(a)** Which plot corresponds to the quantity requested 
in problem 2a? Please store your answer in a variable named
`ans_3a`.

**(b)** Which plot corresponds to the quantity requested 
in problem 2b? Please store your answer in a variable named
`ans_3b`.

**(c)** Which plot corresponds to the quantity requested 
in problem 2c? Please store your answer in a variable named
`ans_3c`.

**(d)** Which plot corresponds to the quantity requested 
in problem 2d? Please store your answer in a variable named
`ans_3d`.

**(e)** Which plot corresponds to the quantity requested 
in problem 2e? Please store your answer in a variable named
`ans_3e`.

**(f)** Which plot corresponds to the quantity requested 
in problem 2f? Please store your answer in a variable named
`ans_3f`.

**(g)** Which plot corresponds to the quantity requested 
in problem 2g? Please store your answer in a variable named
`ans_3g`.

**(h)** Which plot corresponds to the quantity requested 
in problem 2h? Please store your answer in a variable named
`ans_3h`.

## 4.

```{r, echo=F, fig.width=10}
x <- seq(-4, 4, 0.01)
fx <- dnorm(x)
d <- data.table(x, fx)
ga <- ggplot(d, aes(x, fx)) +
  geom_line() +
  ylab('f(x)')

n <- 2
p <- 0.2
y <- seq(0, n, 1)
fy <- dbinom(y, n, p)
d <- data.table(y, fy)
gb <- ggplot(d, aes(y, fy)) +
  geom_segment(data=d, aes(x=y, xend=y, y=0, yend=dbinom(y,n,p))) +
  scale_x_continuous(breaks=-5:5) +
  scale_y_continuous(breaks=fy) +
  ylab('f(y)')

ggarrange(ga, gb, ncol=2)
```

**a.** What is the population mean of $X$? Store your answer
in a variable named `ans_4a`.

**b.** What is the population mean of $Y$? Sore your answer
in a variable named `ans_4b`.

## 5.
**a.** Use the `fread` function in the `data.table` library
to read
`https://crossley.github.io/cogs2020/data/criterion_learning/crit_learn.csv`
into a `data.table` and store the result in a variable named
`ans_5a`.

**b.** Create a new `data.table` that contains only rows of
`ans_5a` for which `cnd` is `%in%` `c('Delay', 'Long ITI',
'Short ITI')`, and only the `sub`, `cnd` and `t2c` columns.
Store your result in a variable named `ans_5b`.

**c.** Is `ans_5b` in wide or long format? Please use one of
the following lines to store your result in a variable named
`ans_4c`:

* `ans_5c <- 'wide'`
* `ans_5c <- 'long'`
  
**d.** If `ans_5b` is in long format, then convert it to
wide format. If it is already wide format, then convert it
to long format. Store your result in a variable named
`ans_5d`. Please also be careful to not alter `ans_5b` in
the process.

**e.** Please recreate the following figure using `ans_5b`
as the source of data being plotted. Store the result of
your call to the `ggplot()` function in a variable named
`ans_5e`.

```{r, echo=F, include=T}
d <- fread('https://crossley.github.io/cogs2020/data/criterion_learning/crit_learn.csv')
d <- d[cnd %in% c('Delay', 'Long ITI', 'Short ITI'), .(sub, cnd, t2c)]
ggplot(data=d, aes(x=cnd, y=t2c)) + 
  geom_violin() + 
  geom_point()
```